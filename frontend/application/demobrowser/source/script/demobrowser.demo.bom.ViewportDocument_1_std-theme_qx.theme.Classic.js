if(!window.qxsettings)qxsettings={};qxsettings["qx.application"]="demobrowser.demo.bom.ViewportDocument_1_std";qxsettings["qx.allowUrlVariants"]=true;qxsettings["qx.allowUrlSettings"]=true;if(!window.qxvariants)qxvariants={};qxvariants["qx.theme"]="qx.theme.Classic";
qxsettings["qx.theme"]="qx.theme.Classic";if(!window.qxlibraries)qxlibraries={};qxlibraries["qx"]={"resourceUri":"../../../../../framework/source/resource"};qxlibraries["demobrowser.demo"]={"resourceUri":"../../../source/resource"};if(!window.qxresourceinfo)qxresourceinfo={};if(!window.qxlocales)qxlocales={};qxlocales["fr"]={"cldr_date_format_long": "d MMMM yyyy", "cldr_month_abbreviated_11": "nov.", "cldr_month_abbreviated_10": "oct.", "cldr_month_abbreviated_12": "d\u00e9c.", "quotationStart": "\u00ab", "cldr_date_time_format_mmss": "mm:ss", "cldr_day_abbreviated_tue": "mar.", "cldr_date_time_format_MMd": "d\/MM", "cldr_day_wide_fri": "vendredi", "cldr_date_time_format_yyMMMd": "d. MMM yy", "cldr_date_time_format_HHmm": "HH:mm", "cldr_day_wide_tue": "mardi", "cldr_day_wide_thu": "jeudi", "cldr_date_time_format_MMMdd": "dd MMM", "cldr_day_abbreviated_fri": "ven.", "cldr_day_wide_sun": "dimanche", "cldr_day_wide_mon": "lundi", "cldr_day_abbreviated_mon": "lun.", "cldr_pm": "PM", "alternateQuotationEnd": "\u201d", "cldr_day_narrow_sun": "D", "cldr_number_percent_format": "#,##0\u00a0%", "cldr_month_narrow_12": "D", "cldr_date_time_format_yyMMMEEEd": "EEE d MMM yy", "cldr_month_narrow_5": "M", "cldr_day_narrow_sat": "S", "cldr_date_time_format_yyQ": "Q yy", "cldr_date_time_format_Md": "d\/M", "cldr_date_format_full": "EEEE d MMMM yyyy", "cldr_month_abbreviated_9": "sept.", "cldr_month_abbreviated_8": "ao\u00fbt", "cldr_month_narrow_10": "O", "cldr_month_narrow_11": "N", "cldr_date_time_format_yyMMM": "MMM yy", "cldr_date_format_medium": "d MMM yyyy", "cldr_month_abbreviated_1": "janv.", "cldr_month_abbreviated_3": "mars", "cldr_month_abbreviated_2": "f\u00e9vr.", "cldr_month_abbreviated_5": "mai", "cldr_month_abbreviated_4": "avr.", "cldr_month_abbreviated_7": "juil.", "cldr_month_abbreviated_6": "juin", "cldr_day_wide_sat": "samedi", "cldr_date_time_format_MMMEd": "E d MMM", "cldr_day_abbreviated_wed": "mer.", "cldr_day_narrow_wed": "M", "cldr_number_group_separator": "\u00a0", "cldr_date_time_format_hhmmss": "hh:mm:ss a", "cldr_month_wide_2": "f\u00e9vrier", "cldr_month_wide_3": "mars", "cldr_month_wide_1": "janvier", "cldr_month_wide_6": "juin", "cldr_month_wide_7": "juillet", "cldr_month_wide_4": "avril", "cldr_month_wide_5": "mai", "cldr_month_wide_8": "ao\u00fbt", "cldr_month_wide_9": "septembre", "quotationEnd": "\u00bb", "cldr_month_wide_10": "octobre", "cldr_month_wide_11": "novembre", "cldr_month_wide_12": "d\u00e9cembre", "cldr_date_time_format_MMdd": "dd\/MM", "cldr_number_decimal_separator": ",", "cldr_day_narrow_fri": "V", "cldr_day_narrow_tue": "M", "alternateQuotationStart": "\u201c", "cldr_day_narrow_thu": "J", "cldr_date_time_format_yyyyMMMM": "MMMM yyyy", "cldr_time_format_short": "HH:mm", "cldr_time_format_medium": "HH:mm:ss", "cldr_day_abbreviated_sun": "dim.", "cldr_day_abbreviated_thu": "jeu.", "cldr_date_format_short": "dd\/MM\/yy", "cldr_time_format_long": "HH:mm:ss z", "cldr_date_time_format_HHmmss": "HH:mm:ss", "cldr_day_wide_wed": "mercredi", "cldr_day_narrow_mon": "L", "cldr_date_time_format_hhmm": "hh:mm a", "cldr_month_narrow_1": "J", "cldr_month_narrow_2": "F", "cldr_month_narrow_3": "M", "cldr_month_narrow_4": "A", "cldr_date_time_format_MMMMd": "d MMMM", "cldr_month_narrow_6": "J", "cldr_month_narrow_7": "J", "cldr_month_narrow_8": "A", "cldr_month_narrow_9": "S", "cldr_day_abbreviated_sat": "sam.", "cldr_date_time_format_yyMM": "MM\/yy", "cldr_am": "AM", "cldr_time_format_full": "HH:mm:ss v", "cldr_date_time_format_yyQQQQ": "QQQQ yy"};qxlocales["en"]={"cldr_date_format_long": "MMMM d, yyyy", "cldr_date_time_format_MMMd": "d-MMM", "cldr_time_format_long": "h:mm:ss a z", "cldr_month_abbreviated_11": "Nov", "cldr_month_abbreviated_10": "Oct", "cldr_date_time_format_yyyyM": "M\/yyyy", "cldr_month_abbreviated_12": "Dec", "cldr_day_narrow_tue": "T", "cldr_date_time_format_HHmmss": "HH:mm:ss", "cldr_day_abbreviated_sat": "Sat", "cldr_date_time_format_mmss": "mm:ss", "cldr_day_abbreviated_tue": "Tue", "cldr_day_narrow_wed": "W", "cldr_date_time_format_MMd": "d\/MM", "cldr_day_wide_fri": "Friday", "cldr_number_decimal_separator": ".", "cldr_date_time_format_HHmm": "HH:mm", "cldr_month_wide_2": "February", "cldr_month_wide_3": "March", "cldr_month_wide_1": "January", "cldr_month_wide_6": "June", "cldr_month_wide_7": "July", "cldr_month_wide_4": "April", "cldr_month_wide_5": "May", "cldr_month_wide_8": "August", "cldr_month_wide_9": "September", "cldr_time_format_full": "h:mm:ss a v", "cldr_am": "AM", "cldr_month_wide_10": "October", "cldr_month_wide_11": "November", "cldr_month_wide_12": "December", "cldr_day_abbreviated_fri": "Fri", "cldr_month_abbreviated_9": "Sep", "cldr_date_format_full": "EEEE, MMMM d, yyyy", "cldr_date_time_format_yyyyMMM": "MMM yyyy", "cldr_day_wide_mon": "Monday", "cldr_day_wide_tue": "Tuesday", "cldr_day_wide_sat": "Saturday", "cldr_day_abbreviated_mon": "Mon", "cldr_day_narrow_thu": "T", "cldr_time_format_short": "h:mm a", "cldr_time_format_medium": "h:mm:ss a", "cldr_day_abbreviated_sun": "Sun", "cldr_pm": "PM", "cldr_date_time_format_hhmm": "hh:mm a", "cldr_date_time_format_yyQQQQ": "QQQQ yy", "cldr_date_time_format_Md": "M\/d", "cldr_day_abbreviated_thu": "Thu", "cldr_date_format_short": "M\/d\/yy", "cldr_day_narrow_sun": "S", "cldr_day_narrow_fri": "F", "cldr_date_time_format_MMMMdd": "dd MMMM", "cldr_day_wide_wed": "Wednesday", "cldr_day_narrow_mon": "M", "cldr_date_time_format_MMMMd": "MMMM d", "cldr_day_narrow_sat": "S", "cldr_month_narrow_1": "J", "cldr_month_narrow_2": "F", "cldr_month_narrow_3": "M", "cldr_month_narrow_4": "A", "cldr_month_narrow_5": "M", "cldr_month_narrow_6": "J", "cldr_month_narrow_7": "J", "cldr_month_narrow_8": "A", "cldr_month_narrow_9": "S", "cldr_date_time_format_MMMdd": "dd MMM", "cldr_day_wide_thu": "Thursday", "cldr_date_time_format_hhmmss": "hh:mm:ss a", "cldr_day_abbreviated_wed": "Wed", "cldr_day_wide_sun": "Sunday", "cldr_date_time_format_yyMM": "MM\/yy", "cldr_month_narrow_12": "D", "cldr_month_abbreviated_8": "Aug", "cldr_month_narrow_10": "O", "cldr_month_narrow_11": "N", "cldr_date_time_format_yyQ": "Q yy", "cldr_number_group_separator": ",", "cldr_date_format_medium": "MMM d, yyyy", "cldr_month_abbreviated_1": "Jan", "cldr_month_abbreviated_3": "Mar", "cldr_month_abbreviated_2": "Feb", "cldr_month_abbreviated_5": "May", "cldr_month_abbreviated_4": "Apr", "cldr_month_abbreviated_7": "Jul", "cldr_month_abbreviated_6": "Jun"};qxlocales["fr_FR"]={};qxlocales["de"]={"cldr_date_format_long": "d. MMMM yyyy", "cldr_month_abbreviated_11": "Nov.", "cldr_month_abbreviated_10": "Okt.", "cldr_month_abbreviated_12": "Dez.", "cldr_date_time_format_MMMMdd": "dd. MMMM", "quotationStart": "\u201a", "cldr_date_time_format_mmss": "mm:ss", "cldr_day_abbreviated_tue": "Di", "cldr_date_time_format_MMd": "d\/MM", "cldr_day_wide_fri": "Freitag", "cldr_date_time_format_HHmm": "HH:mm", "cldr_day_wide_tue": "Dienstag", "cldr_date_time_format_Ed": "E d", "cldr_day_wide_thu": "Donnerstag", "cldr_day_abbreviated_fri": "Fr", "cldr_day_wide_sun": "Sonntag", "cldr_day_wide_mon": "Montag", "cldr_date_time_format_yyyy": "yyyy", "cldr_day_abbreviated_mon": "Mo", "cldr_pm": "nachm.", "alternateQuotationEnd": "\u201c", "cldr_day_narrow_sun": "S", "cldr_number_percent_format": "#,##0 %", "cldr_month_narrow_12": "D", "quotationEnd": "\u2018", "cldr_date_time_format_MMMMd": "d. MMMM", "cldr_day_narrow_sat": "S", "cldr_date_time_format_yyQ": "Q yy", "cldr_date_format_medium": "dd.MM.yyyy", "cldr_date_format_full": "EEEE, d. MMMM yyyy", "cldr_month_abbreviated_9": "Sept.", "cldr_month_abbreviated_8": "Aug.", "cldr_month_narrow_10": "O", "cldr_month_narrow_11": "N", "cldr_date_time_format_yyMMM": "MMM yy", "cldr_month_abbreviated_1": "Jan", "cldr_month_abbreviated_3": "Mrz", "cldr_month_abbreviated_2": "Feb", "cldr_month_abbreviated_5": "Mai", "cldr_month_abbreviated_4": "Apr", "cldr_month_abbreviated_7": "Jul.", "cldr_month_abbreviated_6": "Jun", "cldr_day_wide_sat": "Samstag", "cldr_date_time_format_MMMEd": "E MMM d", "cldr_day_abbreviated_wed": "Mi", "cldr_date_time_format_yyMMdd": "dd.MM.yy", "cldr_day_narrow_wed": "M", "cldr_number_group_separator": ".", "cldr_date_time_format_hhmmss": "hh:mm:ss a", "cldr_month_wide_2": "Februar", "cldr_month_wide_3": "M\u00e4rz", "cldr_month_wide_1": "Januar", "cldr_month_wide_6": "Juni", "cldr_month_wide_7": "Juli", "cldr_month_wide_4": "April", "cldr_month_wide_5": "Mai", "cldr_month_wide_8": "August", "cldr_month_wide_9": "September", "cldr_month_wide_10": "Oktober", "cldr_month_wide_11": "November", "cldr_month_wide_12": "Dezember", "cldr_date_time_format_MMdd": "dd.MM", "cldr_number_decimal_separator": ",", "cldr_day_narrow_fri": "F", "cldr_day_narrow_tue": "D", "alternateQuotationStart": "\u201e", "cldr_day_narrow_thu": "D", "cldr_date_time_format_yyyyMMMM": "MMMM yyyy", "cldr_time_format_short": "HH:mm", "cldr_time_format_medium": "HH:mm:ss", "cldr_day_abbreviated_sun": "So", "cldr_date_time_format_H": "H", "cldr_day_abbreviated_thu": "Do", "cldr_date_format_short": "dd.MM.yy", "cldr_time_format_long": "HH:mm:ss z", "cldr_date_time_format_HHmmss": "HH:mm:ss", "cldr_day_wide_wed": "Mittwoch", "cldr_day_narrow_mon": "M", "cldr_date_time_format_hhmm": "hh:mm a", "cldr_month_narrow_1": "J", "cldr_month_narrow_2": "F", "cldr_month_narrow_3": "M", "cldr_month_narrow_4": "A", "cldr_month_narrow_5": "M", "cldr_month_narrow_6": "J", "cldr_month_narrow_7": "J", "cldr_month_narrow_8": "A", "cldr_month_narrow_9": "S", "cldr_date_time_format_Md": "d.M.", "cldr_day_abbreviated_sat": "Sa", "cldr_date_time_format_yyMM": "MM.yy", "cldr_am": "vorm.", "cldr_time_format_full": "HH:mm:ss v", "cldr_date_time_format_yyQQQQ": "QQQQ yy"};qxlocales["C"]={"cldr_date_format_long": "MMMM d, yyyy", "cldr_date_time_format_MMMd": "d-MMM", "cldr_time_format_long": "h:mm:ss a z", "cldr_month_abbreviated_11": "Nov", "cldr_month_abbreviated_10": "Oct", "cldr_date_time_format_yyyyM": "M\/yyyy", "cldr_month_abbreviated_12": "Dec", "cldr_day_narrow_tue": "T", "cldr_date_time_format_HHmmss": "HH:mm:ss", "cldr_day_abbreviated_sat": "Sat", "cldr_date_time_format_mmss": "mm:ss", "cldr_day_abbreviated_tue": "Tue", "cldr_day_narrow_wed": "W", "cldr_date_time_format_MMd": "d\/MM", "cldr_day_wide_fri": "Friday", "cldr_number_decimal_separator": ".", "cldr_date_time_format_HHmm": "HH:mm", "cldr_month_wide_2": "February", "cldr_month_wide_3": "March", "cldr_month_wide_1": "January", "cldr_month_wide_6": "June", "cldr_month_wide_7": "July", "cldr_month_wide_4": "April", "cldr_month_wide_5": "May", "cldr_month_wide_8": "August", "cldr_month_wide_9": "September", "cldr_time_format_full": "h:mm:ss a v", "cldr_am": "AM", "cldr_month_wide_10": "October", "cldr_month_wide_11": "November", "cldr_month_wide_12": "December", "cldr_day_abbreviated_fri": "Fri", "cldr_month_abbreviated_9": "Sep", "cldr_date_format_full": "EEEE, MMMM d, yyyy", "cldr_date_time_format_yyyyMMM": "MMM yyyy", "cldr_day_wide_mon": "Monday", "cldr_day_wide_tue": "Tuesday", "cldr_day_wide_sat": "Saturday", "cldr_day_abbreviated_mon": "Mon", "cldr_day_narrow_thu": "T", "cldr_time_format_short": "h:mm a", "cldr_time_format_medium": "h:mm:ss a", "cldr_day_abbreviated_sun": "Sun", "cldr_pm": "PM", "cldr_date_time_format_hhmm": "hh:mm a", "cldr_date_time_format_yyQQQQ": "QQQQ yy", "cldr_date_time_format_Md": "M\/d", "cldr_day_abbreviated_thu": "Thu", "cldr_date_format_short": "M\/d\/yy", "cldr_day_narrow_sun": "S", "cldr_day_narrow_fri": "F", "cldr_date_time_format_MMMMdd": "dd MMMM", "cldr_day_wide_wed": "Wednesday", "cldr_day_narrow_mon": "M", "cldr_date_time_format_MMMMd": "MMMM d", "cldr_day_narrow_sat": "S", "cldr_month_narrow_1": "J", "cldr_month_narrow_2": "F", "cldr_month_narrow_3": "M", "cldr_month_narrow_4": "A", "cldr_month_narrow_5": "M", "cldr_month_narrow_6": "J", "cldr_month_narrow_7": "J", "cldr_month_narrow_8": "A", "cldr_month_narrow_9": "S", "cldr_date_time_format_MMMdd": "dd MMM", "cldr_day_wide_thu": "Thursday", "cldr_date_time_format_hhmmss": "hh:mm:ss a", "cldr_day_abbreviated_wed": "Wed", "cldr_day_wide_sun": "Sunday", "cldr_date_time_format_yyMM": "MM\/yy", "cldr_month_narrow_12": "D", "cldr_month_abbreviated_8": "Aug", "cldr_month_narrow_10": "O", "cldr_month_narrow_11": "N", "cldr_date_time_format_yyQ": "Q yy", "cldr_number_group_separator": ",", "cldr_date_format_medium": "MMM d, yyyy", "cldr_month_abbreviated_1": "Jan", "cldr_month_abbreviated_3": "Mar", "cldr_month_abbreviated_2": "Feb", "cldr_month_abbreviated_5": "May", "cldr_month_abbreviated_4": "Apr", "cldr_month_abbreviated_7": "Jul", "cldr_month_abbreviated_6": "Jun"};qxlocales["en_US"]={};qxlocales["de_DE"]={};window.qxloader =
{
  parts : {"boot":[0]},
  uris : [["../../../../../framework/source/class/qx/Bootstrap.js","../../../../../framework/source/class/qx/core/Setting.js","../../../../../framework/source/class/qx/bom/client/Engine.js","../../../../../framework/source/class/qx/core/Variant.js","../../../../../framework/source/class/qx/lang/Object.js","../../../../../framework/source/class/qx/core/Aspect.js","../../../../../framework/source/class/qx/Class.js","../../../../../framework/source/class/qx/bom/Event.js","../../../../../framework/source/class/qx/event/Manager.js","../../../../../framework/source/class/qx/dom/Node.js","../../../../../framework/source/class/qx/lang/Array.js","../../../../../framework/source/class/qx/lang/Function.js","../../../../../framework/source/class/qx/event/Registration.js","../../../../../framework/source/class/qx/core/Property.js","../../../../../framework/source/class/qx/core/ObjectRegistry.js","../../../../../framework/source/class/qx/core/Assert.js","../../../../../framework/source/class/qx/Mixin.js","../../../../../framework/source/class/qx/core/MAssert.js","../../../../../framework/source/class/qx/log/Logger.js","../../../../../framework/source/class/qx/core/Object.js","../../../../../framework/source/class/qx/lang/String.js","../../../../../framework/source/class/qx/Interface.js","../../../../../framework/source/class/qx/event/IEventHandler.js","../../../../../framework/source/class/qx/event/handler/Application.js","../../../../../framework/source/class/qx/event/IEventDispatcher.js","../../../../../framework/source/class/qx/event/dispatch/Direct.js","../../../../../framework/source/class/qx/core/Init.js","../../../../../framework/source/class/qx/application/IApplication.js","../../../../../framework/source/class/qx/application/Native.js","../../../source/class/demobrowser/demo/bom/ViewportDocument_1_std.js","../../../../../framework/source/class/qx/lang/Core.js","../../../../../framework/source/class/qx/lang/Generics.js","../../../../../framework/source/class/qx/dev/StackTrace.js","../../../../../framework/source/class/qx/core/AssertionError.js","../../../../../framework/source/class/qx/util/Json.js","../../../../../framework/source/class/qx/util/ColorUtil.js","../../../../../framework/source/class/qx/event/type/Event.js","../../../../../framework/source/class/qx/event/type/Data.js","../../../../../framework/source/class/qx/util/ObjectPool.js","../../../../../framework/source/class/qx/event/Pool.js","../../../../../framework/source/class/qx/event/handler/Object.js","../../../../../framework/source/class/qx/util/DisposeUtil.js","../../../../../framework/source/class/qx/event/dispatch/AbstractBubbling.js","../../../../../framework/source/class/qx/event/dispatch/DomBubbling.js","../../../../../framework/source/class/qx/event/handler/UserAction.js","../../../../../framework/source/class/qx/event/handler/Keyboard.js","../../../../../framework/source/class/qx/event/handler/Mouse.js","../../../../../framework/source/class/qx/event/handler/Capture.js","../../../../../framework/source/class/qx/event/handler/DragDrop.js","../../../../../framework/source/class/qx/event/handler/Element.js","../../../../../framework/source/class/qx/event/handler/Appear.js","../../../../../framework/source/class/qx/bom/Element.js","../../../../../framework/source/class/qx/event/handler/Focus.js","../../../../../framework/source/class/qx/event/type/Focus.js","../../../../../framework/source/class/qx/bom/element/Attribute.js","../../../../../framework/source/class/qx/event/type/Native.js","../../../../../framework/source/class/qx/event/type/Dom.js","../../../../../framework/source/class/qx/event/type/KeyInput.js","../../../../../framework/source/class/qx/bom/client/Platform.js","../../../../../framework/source/class/qx/event/type/KeySequence.js","../../../../../framework/source/class/qx/event/type/Mouse.js","../../../../../framework/source/class/qx/bom/Viewport.js","../../../../../framework/source/class/qx/dom/Hierarchy.js","../../../../../framework/source/class/qx/event/type/Drag.js","../../../../../framework/source/class/qx/event/dispatch/MouseCapture.js","../../../../../framework/source/class/qx/event/handler/Window.js","../../../../../framework/source/class/qx/bom/Document.js","../../../../../framework/source/class/qx/log/appender/Native.js","../../../../../framework/source/class/qx/log/appender/Console.js","../../../../../framework/source/class/qx/bom/Stylesheet.js","../../../../../framework/source/class/qx/util/ResourceManager.js","../../../../../framework/source/class/qx/log/appender/Util.js","../../../../../framework/source/class/qx/dev/ObjectSummary.js","../../../../../framework/source/class/qx/dev/Pollution.js","../../../../../framework/source/class/qx/dev/Profile.js"]],
  boot : "boot",

  runningParts : {},
  loadedParts : {},
  runningPackages : {},
  loadedPackages : {},
  runningScripts : {},
  loadedScripts : {},

  callbackList : [],

  scriptQueue : [],
  inFlushQueue : false,


  // Simple log wrapper
  _log : function(msg, type)
  {
    if (!type) {
      type = "debug";
    }

    if (window.qx && qx.core && qx.log.Logger) {
      qx.log.Logger[type](msg);
    }
  },


  // Main method to manage part loading
  loadPart : function(name, callback, self)
  {
    if (callback && !self) {
      self = window;
    }

    if (this.parts[name]==null)
    {
      this._log("No such part: " + name, "warn");

      if (callback) {
        callback.call(self);
      }

      return;
    }

    if (this.loadedParts[name])
    {
      // this._log("Part " + name + " is already loaded...");
      if (callback) {
        callback.call(self);
      }

      return;
    }

    if (this.runningParts[name])
    {
      this._log("The part " + name + " is already in loading state... checking callback");

      if (callback)
      {
        for (var i=0, a=this.callbackList, l=a.length; i<l; i++)
        {
          if (a[i].callback == callback && a[i].self == self)
          {
            this._log("Callback is already registered.");
            return;
          }
        }

        // this._log("Registering callback");
        this.callbackList.push({
          callback : callback,
          self : self || null
        });
      }

      return;
    }

    this.runningParts[name] = true;

    this._log("Loading part " + name + "...");

    var pkgs = this.parts[name];
    var pkg;
    var uris;
    var scripts = [];

    for (var i=0; i<pkgs.length; i++)
    {
      pkg = pkgs[i];

      if (this.loadedPackages[pkg])
      {
        // this._log("Package: " + pkg + " is already loaded...");
        continue;
      }

      if (this.runningPackages[pkg]) {
        continue;
      }

      // this._log("Loading package: " + pkg);
      this.runningPackages[pkg] = true;

      uris = this.uris[pkg];
      // this._log("Queueing " + uris.length + " files");
      this.scriptQueue.push.apply(this.scriptQueue, uris);
    }



    if (this.scriptQueue.length == 0)
    {
      this.loadedParts[name] = true;

      if (callback) {
        self ? callback.call(self) : callback();
      }

      return;
    }

    if (callback)
    {
      // this._log("Registering callback");
      this.callbackList.push({
        callback : callback,
        self : self || null
      });
    }

    if (!this.inFlushQueue) {
      this._flushQueue();
    }
  },


  _isWebkit : /AppleWebKit\/([^ ]+)/.test(navigator.userAgent),

  _flushQueue : function()
  {
    this.inFlushQueue = true;

    var queue = this.scriptQueue;

    // Queue empty?
    if (queue.length == 0)
    {
      // this._log("Queue flushed successfully!");

      // Move running packages to loaded packages
      for (var pkg in this.runningPackages)
      {
        // this._log("Package " + pkg + " successfully loaded");
        this.loadedPackages[pkg] = true;
      }
      this.runningPackages = {};

      for (var part in this.runningParts)
      {
        this._log("Part " + part + " successfully loaded");
        this.loadedParts[part] = true;
      }
      this.runningParts = {};

      // Clear flag
      this.inFlushQueue = false;

      // Execute callbacks
      var callbacks = this.callbackList.concat();
      this.callbackList.length = 0;
      for (var i=0, l=callbacks.length; i<l; i++) {
        callbacks[i].callback.call(callbacks[i].self);
      }

      // Is this the boot module? => start init process
      if (part == this.boot)
      {
        this._bootLoaded = true;
        this._fireReady();
      }

      // Finally return
      return;
    }

    // Load next script
    var next = queue.shift();

    if (this._isWebkit)
    {
      // force asynchronous load
      // Safari fails with an "maximum recursion depth exceeded" error if it is
      // called sync.
      var self = this;
      window.setTimeout(function() {
        self.loadScript(next, self._flushQueue, self);
      }, 0);
    } else {
      this.loadScript(next, this._flushQueue, this);
    }
  },


  _fireReady : function()
  {
    if (this._bootLoaded && this._pageLoaded && window.qx && qx.event && qx.event.handler && qx.event.handler.Application) {
      qx.event.handler.Application.ready();
    }
  },


  loadScript : function(uri, callback, self)
  {
    if (callback && !self) {
      self = window;
    }

    if (this.loadedScripts[uri])
    {
      // this._log("Script is already loaded: " + uri);

      if (callback) {
        callback.call(self);
      }

      return;
    }

    // This needs a better implementation!
    if (this.runningScripts[uri]) {
      throw new Error("Script is already loading.");
    }

    this.runningScripts[uri] = true;

    var head = document.getElementsByTagName("head")[0];
    var elem = document.createElement("script");

    elem.charset = "utf-8";
    elem.src = uri;

    // Assign listener
    elem.onreadystatechange = elem.onload = function()
    {
      if (!this.readyState || this.readyState == "loaded" || this.readyState == "complete")
      {
        // Remove listeners (mem leak prevention)
        elem.onreadystatechange = elem.onload = null;

        // Remember
        delete qxloader.runningScripts[uri];
        qxloader.loadedScripts[uri] = true;

        // Execute callback
        if (callback) {
          callback.call(self);
        }
      }
    };

    head.appendChild(elem);
  },


  _pageLoad : function()
  {
    if (window.addEventListener) {
      window.removeEventListener("load", qxloader._pageLoad, false);
    } else {
      window.detachEvent("onload", qxloader._pageLoad);
    }

    qxloader._pageLoaded = true;
    qxloader._fireReady();
  },


  init : function() {
    this.loadPart(this.boot);
  }
};

if (window.addEventListener) {
  window.addEventListener("load", qxloader._pageLoad, false);
} else {
  window.attachEvent("onload", qxloader._pageLoad);
}

qxloader.init();
